#Re-class time in minutes from midnight to create a linear model
error$time <- sprintf("%04d", error$time)
error$time <- format(strptime(error$time, format = "%H%M"), format = "%H:%M")
error$time <- as.numeric(hm(error$time))/60
#Generate a linear model of gross weight against time
lr <- lm(gross.weight ~ time, error)
plot(error$time, error$gross.weight)
abline(lr)
error[order(error$time),]
#Predict gross weight for erroneous value.
ev <- round(as.vector(predict(lr, data.frame(time = error$time[is.na(error$gross.weight) == T]))),1)
#Replace erroneous value with extrapolated value
#Add 1 to extrapolated column (0 = no & 1 = yes if data is extrapolated.
#Add text explaining how data was extrapolated.
weights.mod$gross.weight[weights.mod$sample.type == sm & weights.mod$Sample == sn &
weights.mod$scan == st & weights.mod$location == el] <- ev
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 1
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - Gross weight extrapolated based on linear model of three weights at other sampling locations."
show <- weights.mod[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st,]
show[order(show$time),]
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#################################################     DOUGLAS-FIR          ##################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 15
#This error was caused by incorrect transcription of data from paper data sheet to Google spreadhseet.
#Error was corrected on spreadsheet.
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 16
#This error was caused by incorrect transcription of data from paper data sheet to Google spreadhseet.
#Error was corrected on spreadsheet.
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 17
#Sample Type
sm <- "DF"
#Sample Number
sn <- 5
#Scan Time
st <- "48.0"
#Error Location
el <- 3
#Isolate sample for specified scane time.
error <- weights[weights$sample.type == sm & weights$Sample == sn & weights$scan == st,]
error[order(error$time),]
#Remove erroneous weight
error$gross.weight[error$location == el] <- NA
#Re-class time in minutes from midnight to create a linear model
error$time <- sprintf("%04d", error$time)
error$time <- format(strptime(error$time, format = "%H%M"), format = "%H:%M")
error$time <- as.numeric(hm(error$time))/60
#Generate a linear model of gross weight against time
lr <- lm(gross.weight ~ time, error)
plot(error$time, error$gross.weight)
abline(lr)
error[order(error$time),]
#Predict gross weight for erroneous value.
ev <- round(as.vector(predict(lr, data.frame(time = error$time[is.na(error$gross.weight) == T]))),1)
#Replace erroneous value with extrapolated value
#Add 1 to extrapolated column (0 = no & 1 = yes if data is extrapolated.
#Add text explaining how data was extrapolated.
weights.mod$gross.weight[weights.mod$sample.type == sm & weights.mod$Sample == sn &
weights.mod$scan == st & weights.mod$location == el] <- ev
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 1
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - Gross weight extrapolated based on linear model of three weights at other sampling locations."
show <- weights.mod[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st,]
show[order(show$time),]
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 18
#Sample Type
sm <- "DF"
#Sample Number
sn <- 7
#Scan Time
st <- "od"
#Error Location
el <- 3
#Correct value location
#Sample Type
cor.sm <- "DF"
#Sample Number
cor.sn <- 8
#Scan Time
cor.st <- "od"
#Error Location
cor.el <- 3
#Correct value
correct.value <- weights$gross.weight[weights$sample.type == cor.sm &
weights$Sample == cor.sn &
weights$scan == cor.st &
weights$location == cor.el]
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan: Assumed error. Gross weight (596.3) for sample 7, oven-dry scan, 3-meter location was accidentally recorded as sample 8, oven-dry scan, 3-meter location and gross weight (579.42) for sample 8, oven-dry scan, 3-meter location was accidentally recorded here. Switched values."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 19
#Sample Type
sm <- "DF"
#Sample Number
sn <- 8
#Scan Time
st <- "od"
#Error Location
el <- 3
#Correct value location
#Sample Type
cor.sm <- "DF"
#Sample Number
cor.sn <- 7
#Scan Time
cor.st <- "od"
#Error Location
cor.el <- 3
#Correct value
correct.value <- weights$gross.weight[weights$sample.type == cor.sm &
weights$Sample == cor.sn &
weights$scan == cor.st &
weights$location == cor.el]
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan: Assumed error. Gross weight (579.42) for sample 7, oven-dry scan, 3-meter location was accidentally recorded as sample 8, oven-dry scan, 3-meter location and gross weight (596.3) for sample 8, oven-dry scan, 3-meter location was accidentally recorded here. Switched values."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 20
#Sample Type
sm <- "DF"
#Sample Number
sn <- 9
#Scan Time
st <- "od"
#Error Location
el <- 9
#Correct value
correct.value <- 589.32
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - I changed value from 584.32 to 589.32. Paper data sheet could be either value, but sample 9 weights at other locations all fall betwen 589.0 and 589.9."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 21-26
#Missing fuel moisture values for all 9-meter oven-dry scans for Douglas-fir samples.
#This error was caused by a scripting type and was corrected.
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#################################################     PONDEROSA PINE      ###################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 37
#Sample Type
sm <- "PP"
#Sample Number
sn <- 26
#Scan Time
st <- "48.0"
#Error Location
el <- 12
#Correct value
correct.value <- 628.2
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - changed value from 638.2 to 628.2. The other three values for this sample at the 48-hr scan time are between 628.0 and 628.5. Highly likely person entering data recorded a three instead of a two."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#################################################     SOUTHERN RED OAK      #################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 38
#Sample Type
sm <- "SRO"
#Sample Number
sn <- 6
#Scan Time
st <- "2.0"
#Error Location
el <- 3
#Isolate sample for specified scane time.
error <- weights[weights$sample.type == sm & weights$Sample == sn & weights$scan == st,]
error[order(error$time),]
#Remove erroneous weight
error$gross.weight[error$location == el] <- NA
#Re-class time in minutes from midnight to create a linear model
error$time <- sprintf("%04d", error$time)
error$time <- format(strptime(error$time, format = "%H%M"), format = "%H:%M")
error$time <- as.numeric(hm(error$time))/60
#Generate a linear model of gross weight against time
lr <- lm(gross.weight ~ time, error)
plot(error$time, error$gross.weight)
abline(lr)
error[order(error$time),]
#Predict gross weight for erroneous value.
ev <- round(as.vector(predict(lr, data.frame(time = error$time[is.na(error$gross.weight) == T]))),1)
#Replace erroneous value with extrapolated value
#Add 1 to extrapolated column (0 = no & 1 = yes if data is extrapolated.
#Add text explaining how data was extrapolated.
weights.mod$gross.weight[weights.mod$sample.type == sm & weights.mod$Sample == sn &
weights.mod$scan == st & weights.mod$location == el] <- ev
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 1
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - Gross weight extrapolated based on linear model of three weights at other sampling locations."
show <- weights.mod[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st,]
show[order(show$time),]
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 39
#Sample Type
sm <- "SRO"
#Sample Number
sn <- 13
#Scan Time
st <- "8.0"
#Error Location
el <- 3
#Correct value location
#Sample Type
cor.sm <- "SRO"
#Sample Number
cor.sn <- 15
#Scan Time
cor.st <- "8.0"
#Error Location
cor.el <- 3
#Correct value
correct.value <- weights$gross.weight[weights$sample.type == cor.sm &
weights$Sample == cor.sn &
weights$scan == cor.st &
weights$location == cor.el]
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - I switched this value (521.09) with the value for sample 15 (514.86) at the 8-hr scan/3-meter location. Values line up much better with other locations at this scan for this sample when they are switched. Highly likely staff recording data for samples got tray 13 and 15 mixed up."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 40
#Sample Type
sm <- "SRO"
#Sample Number
sn <- 15
#Scan Time
st <- "8.0"
#Error Location
el <- 3
#Correct value location
#Sample Type
cor.sm <- "SRO"
#Sample Number
cor.sn <- 13
#Scan Time
cor.st <- "8.0"
#Error Location
cor.el <- 3
#Correct value
correct.value <- weights$gross.weight[weights$sample.type == cor.sm &
weights$Sample == cor.sn &
weights$scan == cor.st &
weights$location == cor.el]
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - I switched this value (514.86) with the value for sample 13 (521.09) at the 8-hr scan/3-meter location. Values line up much better with other locations at this scan for this sample when they are switched. Highly likely staff recording data for samples got tray 13 and 15 mixed up."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 41
#Sample Type
sm <- "SRO"
#Sample Number
sn <- 14
#Scan Time
st <- "od"
#Error Location
el <- 3
#Isolate sample for specified scane time.
error <- weights[weights$sample.type == sm & weights$Sample == sn & weights$scan == st,]
error[order(error$time),]
#Remove erroneous weight
error$gross.weight[error$location == el] <- NA
#Re-class time in minutes from midnight to create a linear model
error$time <- sprintf("%04d", error$time)
error$time <- format(strptime(error$time, format = "%H%M"), format = "%H:%M")
error$time <- as.numeric(hm(error$time))/60
#Generate a linear model of gross weight against time
lr <- lm(gross.weight ~ time, error)
plot(error$time, error$gross.weight)
abline(lr)
error[order(error$time),]
#Predict gross weight for erroneous value.
ev <- round(as.vector(predict(lr, data.frame(time = error$time[is.na(error$gross.weight) == T]))),1)
#Replace erroneous value with extrapolated value
#Add 1 to extrapolated column (0 = no & 1 = yes if data is extrapolated.
#Add text explaining how data was extrapolated.
weights.mod$gross.weight[weights.mod$sample.type == sm & weights.mod$Sample == sn &
weights.mod$scan == st & weights.mod$location == el] <- ev
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 1
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - Gross weight extrapolated based on linear model of three weights at other sampling locations."
show <- weights.mod[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st,]
show[order(show$time),]
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################J. Cronan - I switched this value (514.86) with the value for sample 13 (521.09) at the 8-hr scan/3-meter location. Values line up much better with other locations at this scan for this sample when they are switched. Highly likely staff recording data for samples got tray 13 and 15 mixed up.
#Error 42
#Sample Type
sm <- "SRO"
#Sample Number
sn <- 15
#Scan Time
st <- "24.0"
#Error Location
el <- 9
#Isolate sample for specified scane time.
error <- weights[weights$sample.type == sm & weights$Sample == sn & weights$scan == st,]
error[order(error$time),]
#Remove erroneous weight
error$gross.weight[error$location == el] <- NA
#Re-class time in minutes from midnight to create a linear model
error$time <- sprintf("%04d", error$time)
error$time <- format(strptime(error$time, format = "%H%M"), format = "%H:%M")
error$time <- as.numeric(hm(error$time))/60
#Generate a linear model of gross weight against time
lr <- lm(gross.weight ~ time, error)
plot(error$time, error$gross.weight)
abline(lr)
error[order(error$time),]
#Predict gross weight for erroneous value.
ev <- round(as.vector(predict(lr, data.frame(time = error$time[is.na(error$gross.weight) == T]))),1)
#Replace erroneous value with extrapolated value
#Add 1 to extrapolated column (0 = no & 1 = yes if data is extrapolated.
#Add text explaining how data was extrapolated.
weights.mod$gross.weight[weights.mod$sample.type == sm & weights.mod$Sample == sn &
weights.mod$scan == st & weights.mod$location == el] <- ev
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 1
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"Gross weight extrapolated based on linear model of three weights at other sampling locations."
show <- weights.mod[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st,]
show[order(show$time),]
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################J. Cronan - I switched this value (514.86) with the value for sample 13 (521.09) at the 8-hr scan/3-meter location. Values line up much better with other locations at this scan for this sample when they are switched. Highly likely staff recording data for samples got tray 13 and 15 mixed up.
#Error 43
#Not an error
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#################################################     LONGLEAF PINE      ####################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 44-59
#Scan values were incorrectly transcribed (as 36-hr instead of 48-hr) from the data sheets to the Google spreadsheet.
#I corrected scan time values on spreadsheet so they are the same as paper data sheets.
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 60
#Sample Type
sm <- "LLP"
#Sample Number
sn <- 21
#Scan Time
st <- "od"
#Error Location
el <- 3
#Correct value
correct.value <- 598.25
weights.mod$gross.weight[weights.mod$sample.type == sm &
weights.mod$Sample == sn &
weights.mod$scan == st &
weights.mod$location == el] <- correct.value
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 2
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - Negative fuel moisture. The original value was 593.25, but this yields a negative fuel moisture. Highly likely that person recording data misread the eight as a three."
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Error 61
#Sample Type
sm <- "LLP"
#Sample Number
sn <- 30
#Scan Time
st <- "od"
#Error Location
el <- 9
#Isolate sample for specified scane time.
error <- weights[weights$sample.type == sm & weights$Sample == sn & weights$scan == st,]
error[order(error$time),]
#Remove erroneous weight
error$gross.weight[error$location == el] <- NA
#Re-class time in minutes from midnight to create a linear model
error$time <- sprintf("%04d", error$time)
error$time <- format(strptime(error$time, format = "%H%M"), format = "%H:%M")
error$time <- as.numeric(hm(error$time))/60
#Generate a linear model of gross weight against time
lr <- lm(gross.weight ~ time, error)
plot(error$time, error$gross.weight)
abline(lr)
error[order(error$time),]
#Predict gross weight for erroneous value.
ev <- round(as.vector(predict(lr, data.frame(time = error$time[is.na(error$gross.weight) == T]))),1)
#Replace erroneous value with extrapolated value
#Add 1 to extrapolated column (0 = no & 1 = yes if data is extrapolated.
#Add text explaining how data was extrapolated.
weights.mod$gross.weight[weights.mod$sample.type == sm & weights.mod$Sample == sn &
weights.mod$scan == st & weights.mod$location == el] <- ev
weights.mod$mod_type[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <- 1
weights.mod$modification_notes[weights.mod$sample.type == sm &
weights.mod$Sample == sn & weights.mod$scan == st &
weights.mod$location == el] <-
"J. Cronan - Gross weight extrapolated based on linear model of three weights at other sampling locations."
show <- weights.mod[weights.mod$sample.type == sm & weights.mod$Sample == sn & weights.mod$scan == st,]
show[order(show$time),]
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#Save table of sample weights with values extrapolated in this script.
setwd("C:/Users/jcronan/Documents/GitHub/lidar_fuel_moisture_qaqc")
write.csv(weights.mod, "sample_weights_modfied_weights.csv", row.names = F)
#############################################################################################################################################
#############################################################################################################################################
#############################################################################################################################################
#End
